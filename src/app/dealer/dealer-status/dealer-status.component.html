<ngx-spinner class="custom_loder">
  <img src="../../../assets/Loader.gif">
  </ngx-spinner>
<div class="container pad_t_5per pad_b_5per">
  <div class="row">
    <div class="col-sm-12 col-md-12 col-lg-12 col-xs-12 text-center">
      <h3 class="shopee_name">
        <span> {{loginUserData.content}}</span>
      </h3>
      <img class="s_bpy_ctg" src="../../assets/images/Underline Shaded.svg">
    </div>
  </div>
  <p class="bread-crumb1">
    <span>
      <a href="javascript.void(0)" routerLink="/dashboard">Dashboard</a>
    </span>&nbsp;>&nbsp;
    <!-- <span> -->
      <!-- <a href="javascript.void(0)" routerLink="/Dealer-ORDERS">Orders</a>
    </span>&nbsp;>&nbsp; -->
    <span>Status</span>
  </p>
  <div class="row" *ngIf="loginUserData.role=='Marketing Manager'">
  <div class="fr" >
    <input type="text" class="form-control" [(ngModel)]="searchText" placeholder="Search..." class="search_style">
    <button type="submit" class="input_btn">Search</button>
  </div>
</div>
<br>
  <!-- <section *ngIf="loginUserData.role=='Marketing Manager'"
    [ngStyle]="{'padding-top':ven_POHidden === true ? '1%' : '3%','transition':'0.7s' }">
    <div class="chose_vendr">
      <div class="col-md-12   text-center">
        <div class="form-group">
          <label class="vendor_lab" for="sel1">Choose Dealer </label>
          <span>
            <select class="vendor_sel" [(ngModel)]="selectedObj" (ngModelChange)="dealer_chn($event)" id="sel1">
              <option [ngValue]="undefined" disabled selected>Select Dealer</option>
              <option *ngFor="let p of dealers" [ngValue]="p">{{p.business_name}}</option>
            </select>
          </span>
        </div>
      </div>
    </div>
  </section> -->
 
  <section *ngIf="ven_POHidden">
    <div class="row tabwraper">
      <div class="row bg-theme dash_status" style="margin:0px">
        <div class="col-md-3 status_align">
          <a href="javascript:void(0)" [ngClass]="{'active_tab':POhidden == true}" (click)="po()">Placed Orders</a>
        </div>
          <div class="col-md-3 status_align">
        <a href="javascript:void(0)" [ngClass]="{'active_tab':PENhidden == true}" (click)="pen()">Pending Orders</a>
      </div>
        <div class="col-md-3 status_align">
          <a href="javascript:void(0)" [ngClass]="{'active_tab':DOhidden == true}" (click)="do()">Delivered Orders</a>
        </div>
     
        <div class="col-md-3 status_align">
          <a href="javascript:void(0)" [ngClass]="{'active_tab':GRNhidden == true}" (click)="grn()">Cancelled Orders</a>
        </div>
      </div>

      <div class="pad_20">
        
        <div *ngIf="POhidden">
          <div class="row" style="margin:0px">
            <div>
              <div class="row">
                <div class="col-md-6 orderdetdiv">
                  <h4>Order Details:</h4>
                </div>
                <div class="col-md-6 orderdetdiv" *ngIf="loginUserData.role=='Marketing Manager'">
                  <div class="form-group " style="float:right">
                    <select class="form-control" id="sel1" (change)="select_action($event)" name="select" #select1="ngModel" [(ngModel)]="select" >
                      <option disabled value="undefined" >Select</option>
                      <option value="Approve">Approve</option>
                      <option value="Cancel">Cancel</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="row">
              <div class="approverow" *ngIf="loginUserData.role=='Marketing Manager'">
                <div  *ngIf="sel_act=='Approve'">
                <div class="col-md-12">
                    <div class="pull-right">
                        <div class="select_all">                                         
                              <label><input type="checkbox" name="approveall"
                                  (change)="approveall($event)"
                                  style="width:20px;height:15px;">Approve All
                              </label>
                            </div>
                    </div>
                   
                  </div>
                </div>
                <div  *ngIf="sel_act=='Cancel'">
                  <div class="col-md-12">
                    <div class="pull-right">
                        <div class="select_all">
                
                          <label><input type="checkbox" name="cancelall" (change)="approveall($event)"
                            style="width:20px;height:15px;">Cancel All
                          </label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              </div>
              <div>
                <div class="row tabcontent" style="padding: 10px;">
                  <div>
                    <div class="row p_s_1">
                      <div class="col-4 col-md-1 text-center">
                        <h4>S.No</h4>
                      </div>
                        <div class="col-md-2  hidexs">
                        <h4 >Business Name</h4>
                      </div>
                      <div class="col-4 col-md-1 text-center">
                        <h4>PO No</h4>
                      </div>
                      <div class="col-4 col-md-2  text-center">
                        <h4>PO Date</h4>
                      </div>
                     
                      <div class="col-md-1  text-center hidexs">
                        <h4>Product Line</h4>
                      </div>
                      <div class="col-4 col-md-1  text-center pototal">
                        <h4> Taxable</h4>
                      </div>
                      <div class="col-4 col-md-1  text-center pototal">
                        <h4> Discount</h4>
                      </div>
                      <div class="col-4 col-md-1  text-center pototal">
                        <h4> Promo Discount</h4>
                      </div>
                      <div class="col-4 col-md-1  text-center pototal">
                        <h4>PO Total<br>(Including GST)</h4>
                      </div>
                    
                      <!-- <div  class="col-md-1  hidexs">
                        <h4 >Raised By</h4>
                      </div> -->
                      <div class="col-md-1 text-center " *ngIf="loginUserData.role=='Marketing Manager'" >
                        <h4>Actions</h4>
                      </div>
                    </div>

                    <mat-accordion
                      *ngFor="let p of orders | filter:searchText| paginate: { itemsPerPage: 10, currentPage: page }; let i=index">

                      <div  class="statusdata">
                        <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                          <mat-expansion-panel-header>
                            <mat-panel-title>
                              <div class="col-md-1  text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{10*(page-1)+(i+1)}}</span>
                                </p>
                              </div>
                               <div class="col-md-2  hidexs">
                                <p class="txt_black" style="margin-bottom: 0px;text-align:left ">
                                  <span>&nbsp;&nbsp;{{p.business_name }}
                                  </span>
                                </p>
                              </div>
                              <div class="col-md-1  text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{p.spo_no }}
                                  </span>
                                </p>
                              </div>
                              <div class="col-md-2  podatediv">
                                <p class="txt_black" style="margin-bottom: 0px;text-align:right">
                                  <span>&nbsp;&nbsp;{{p.po_date | date:'dd-MM-yyyy'}}</span>
                                </p>
                              </div>
                             
                              <div class="col-md-1  text-center hidexs">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{p.detail.length}}</span>
                                </p>
                              </div>
                              <div class="col-md-1 text-center currencydiv">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span style="position: absolute;right: 10%;">{{p.line_amount| currency : '&nbsp;' }}
                                  </span>
                                </p>
                              </div>
                              <div *ngIf="p.devicediscamount"  class="col-md-1 text-center currencydiv" >
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span style="position: absolute;right: 10%;">{{p.devicediscamount| currency : '&nbsp;' }}
                                  </span>
                                
                                </p>
                              </div>
                              <div *ngIf="!p.devicediscamount" class="col-md-1 text-center currencydiv" >
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span  style="position: absolute;right: 30%;">-
                                  </span>
                                
                                </p>
                              </div>
                              <div *ngIf="p.promo_amount" class="col-md-1 text-center currencydiv" >
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span  style="position: absolute;right: 10%;">{{p.promo_amount| currency : '&nbsp;' }}
                                  </span>
                                 
                                </p>
                              </div>
                              <div *ngIf="!p.promo_amount" class="col-md-1 text-center currencydiv" >
                                <p class="txt_black" style="margin-bottom: 0px;">
                                
                                  <span style="position: absolute;right: 30%;">-
                                  </span>
                                </p>
                              </div>
                              <div class="col-md-1 text-center currencydiv">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span style="position: absolute;right:10%">{{p.final_amount| currency : '&nbsp;' }}
                                  </span>
                                </p>
                              </div>
                             
                              <!-- <div class="col-md-1  text-center hidexs" *ngIf="loginUserData.role=='Marketing Manager'">
                                <p *ngIf="p.self==1" class="txt_black" style="margin-bottom: 0px;color:red; ">
                                  <span>&nbsp;&nbsp;(S)
                                  </span>
                                </p>
                                <p *ngIf="p.self==0" class="txt_black" style="margin-bottom: 0px;color: #293271 ">
                                  <span>&nbsp;&nbsp;(D)
                                  </span>
                                </p>
                              </div> -->
                              <!-- <div class="col-md-1  text-center hidexs" *ngIf="loginUserData.role!='Marketing Manager'">
                                <p *ngIf="p.self==1" class="txt_black" style="margin-bottom: 0px;color:red; ">
                                  <span>&nbsp;&nbsp;(S)
                                  </span>
                                </p>
                                <p *ngIf="p.self==0" class="txt_black" style="margin-bottom: 0px;color: #293271 ">
                                  <span>&nbsp;&nbsp;(M)
                                  </span>
                                </p>
                              </div>
                               -->
                              <div class="col-md-1  text-center" style="padding:5px !important;" *ngIf="loginUserData.role=='Marketing Manager'">
                                <!-- <p class="txt_black" style="margin-bottom: 0px; ">
                                  <span><button class="btn btn-primary">More</button> </span>
                                </p> -->
                                <td *ngIf="loginUserData.role=='Marketing Manager'" style="text-align: right;">
                                  <!-- <button *ngIf="!pd.Dispatched && pd.status !== 'canceled' && sel_act==null && sel_act==undefined " class="btn btn-danger" (click)="can_product(pd)">Cancel</button> -->
                                  <span *ngIf="sel_act=='Approve' ">
                                    <div class="checkbox" *ngIf="state != 'Dispatched'">
                                      <label><input type="checkbox" id="Approve" [checked]="checke"
                                          (change)="sel_action_check($event,p)">{{sel_act}}</label>
                                    </div>
                                  </span>
                                  <!-- <span *ngIf="sel_act=='Cancel' && cmp_d==(pd.dtl_seq_no+''+p.amount)">
                                      <div class="checkbox"> -->
                                  <span *ngIf="sel_act=='Cancel' ">
                                    <div class="checkbox" *ngIf="state != 'Dispatched'">
                                      <label><input type="checkbox" id="Cancel" [checked]="checkc"
                                          (change)="sel_action_check($event,p)">{{sel_act}}</label>
                                    </div>
                                  </span>
                                </td>
                              </div>
                            </mat-panel-title>


                          </mat-expansion-panel-header>
                          <div class="visible-sm-and-lg">
                            <div class="row">
                              <div class="col-md-6" style="margin-bottom: 0px;">
                                <span> <b> Product Line -</b>&nbsp;&nbsp;{{p.detail.length}}</span>
                              </div>
                              <div class="col-md-6" style="margin-bottom: 0px;">
                                <span> <b>Company -</b>&nbsp;&nbsp;{{p.business_name }}</span>
                              </div>
                            </div>

                          </div>
                          <!-- <div class="row">
                          <div class="col-md-6 orderdetdiv">
                            <h4>Order Details:</h4>
                          </div>
                          <div class="col-md-6 orderdetdiv" *ngIf="loginUserData.role=='Marketing Manager'">
                            <div class="form-group " style="float:right">
                              <select class="form-control" id="sel1" (change)="select_action($event,p)">
                                <option disabled>Select</option>
                                <option value="Approve">Approve</option>
                                <option value="Cancel">Cancel</option>
                              </select>
                            </div>
                          </div>
                        </div> -->
                          <div style="max-height: 380px;overflow: auto;">
                          <div class="table-responsive">
                            <table class="table">
                              <thead>
                                <tr>
                                  <th>S.No</th>
                                  <th>Product </th>
                                  <th style="text-align:left"><span class="hidexs">Product</span> Name</th>
                                  <th>Price(&#8377;)</th>
                                  <th>Qty</th>
                                  <th>Net <span class="hidexs">Price</span>(&#8377;)</th>
                                
                                  <!-- <th>GST</th>
                                  <th>Total<span class="hidexs">Price</span>(&#8377;)</th> -->
                                  <th>Status</th>
                                  <!-- <th *ngIf="loginUserData.role=='Marketing Manager'">Actions</th> -->
                                </tr>
                                <!-- <tr class="approverow" *ngIf="loginUserData.role=='Marketing Manager'">
                                  <th colspan="8" *ngIf="sel_act=='Approve' && this.po_no==p.po_no">
                                  <div class="col-md-12">
                                      <div class="pull-right">
                                          <div class="select_all">                                         
                                                <label><input type="checkbox" name="approveall"
                                                    (change)="approveall($event,data,p)"
                                                    style="width:20px;height:15px;">Approve All
                                                </label>
                                              </div>
                                      </div>
                                     
                                    </div>
                                  </th>
                                  <th colspan="8" *ngIf="sel_act=='Cancel' && this.po_no==p.po_no">
                                    <div class="col-md-12">
                                      <div class="pull-right">
                                          <div class="select_all">
                                  
                                            <label><input type="checkbox" name="cancelall" (change)="approveall($event,data,p)"
                                              style="width:20px;height:15px;">Cancel All
                                            </label>
                                        </div>
                                      </div>
                                    </div>
                                  </th>
                                </tr> -->
                                <!-- <tr class="approverow" *ngIf="sel_act=='Cancel' && this.po_no==po.po_no">
                                  <th colspan="11">
                                  <div class="col-md-12">                                 
                                      <div class="pull-right">
                                        <div class="select_all">
                                          <label>  <input type="checkbox" name="cancelall"
                                                (change)="approveall($event,data,po)"
                                                style="width:20px;height:15px;"><b>Cancel All </b>  
                                                </label>                                  
                                        </div>
                                      </div>
                                    </div>
                                  </th>

                                </tr> -->
                                <!-- <div *ngIf="loginUserData.role=='Marketing Manager'">
                                  <div>
                                    <span *ngIf="sel_act=='Approve' && this.po_no==p.po_no">
                                      <div class="select_all col-md-12" style="float: right">
                                        <label><input type="checkbox" name="approveall"
                                            (change)="approveall($event,data,p)"
                                            style="width:20px;height:15px;">Approve_All
                                        </label>
                                      </div>
                                    </span>
                                  </div>
                                  <span *ngIf="sel_act=='Cancel' && this.po_no==p.po_no">
                                    <div class="select_all" style="float: right">
                                      <div>
                                        <div><input type="checkbox" name="cancelall" (change)="approveall($event,data,p)"
                                            style="width:20px;height:15px;">Cancel_All
                                        </div>
                                      </div>
                                    </div>
                                  </span>
                                </div> -->
                              </thead>
                              <tbody>
                                <tr *ngFor="let pd of p.detail ; let i=index;">
                                  <td>{{i + 1}} </td>

                                  <td style="width:10%;">
                                    <div>
                                      <img src="{{pd.image}}"
                                        onError="this.src='https://gstbucket1.s3.ap-south-1.amazonaws.com/Powertexmodel/noimage.png';"
                                        class="img-thumbnail" style="width:70%;height: 30px;">
                                    </div>
                                  </td>
                                  <td style="text-align:left">
                                    <h4 class="table_pd_name">{{pd.subcategory}} {{pd.modelno}}</h4>
                                  </td>
                                  <td>
                                    <div class="row_mar_0">
                                      <span class="f_wt_600">{{pd.net_price | currency : '&nbsp;'}}</span>
                                    </div>
                                  </td>
                                  <td>
                                    <div>
                                      <p>
                                        <span class=" f_wt_600">{{pd.qty }}</span>
                                      </p>
                                    </div>
                                  </td>
                                  <td>
                                    <div>
                                      <p style="margin-bottom: 0px">
                                        <span class=" f_wt_600">{{pd.qty * pd.net_price | currency : '&nbsp;'}}</span>
                                      </p>
                                         <!-- <p class="gsttitle">
                                        (Excluding GST)
                                      </p> -->
                                    </div>
                                  </td>
                                  
                                  <!-- <td>
                                    <div>
                                      <p>
                                        <span class=" f_wt_600">{{p.gst_amount| currency : '&nbsp;'}}</span>
                                      </p>
                                    </div>
                                  </td>
                                  <td>
                                    <div>

                                      <span class="f_wt_600">{{p.final_amount| currency : '&nbsp;'}}</span>&nbsp;
                                         <p class="gsttitle">
                                        (Including GST)
                                      </p>
                                    </div>
                                  </td> -->
                                  <td>
                                    <div>
                                      <p>
                                        <span class=" f_wt_600">{{pd.status}} &nbsp;
                                        
                                        </span>
                                      </p>

                                    </div>

                                  </td>
                                  <!-- <td *ngIf="loginUserData.role=='Marketing Manager'" style="text-align: right;">
                                   
                                    <span *ngIf="sel_act=='Approve' && this.po_no==p.po_no && p.code1==null ">
                                      <div class="checkbox" *ngIf="pd.status != 'Dispatched'">
                                        <label><input type="checkbox" id="Approve" [checked]="checke"
                                            (change)="sel_action_check($event,pd,p)">{{sel_act}}</label>
                                      </div>
                                    </span>
                                   
                                    <span *ngIf="sel_act=='Cancel' && this.po_no==p.po_no && p.code1==null ">
                                      <div class="checkbox" *ngIf="pd.status != 'Dispatched'">
                                        <label><input type="checkbox" id="Cancel" [checked]="checkc"
                                            (change)="sel_action_check($event,pd,p)">{{sel_act}}</label>
                                      </div>
                                    </span>
                                  </td> -->
                                </tr>
                              </tbody>
                            </table>
                            <!-- <div class="row row_mar_0" *ngIf="loginUserData.role=='Marketing Manager' && selected_list.length>0 && this.po_no1==p.po_no">
                              <button style="float:right;" class="btn btn-ord" (click)="sub_sel_data()">Submit</button>
                            </div> -->
                         </div>
                          </div>
                        </mat-expansion-panel>

                      </div>
                    
                    </mat-accordion>
                    <div class="pull-left mar_t_30">
                      <pagination-controls (pageChange)="page = $event"></pagination-controls>
                    </div>
                    <div class="row row_mar_0 pull-right" *ngIf="loginUserData.role=='Marketing Manager' && selected_list.length>0 ">
                      <button style="float:right;" class="btn btn-ord" (click)="sub_sel_data()">Submit</button>
                    </div>
                  </div>
                </div>
                <!-- <div class="col-md-12" >
                <div class="no_data">
                  <img class="no_data_cnter" src="../assets/emptyicon.png" />
                  <span class="nodata_txt">No Data is Available</span>
                </div>
              </div> -->
              </div>
            </div>
          </div>
        </div>
        <div class="modal fade" id="confirm" role="dialog">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-body" style="padding:0;">
                <div class="row">
                  <div class="col-md-12">
                    <h3 class="alert_heading" style="font: bold">
                      <label>Give Your Comments</label>
                    </h3>
                    <div class="modal-body">
                      <div class="form-group">
                        <label>Comment:</label>
                        <textarea type="text" class="form-control" placeholder="write comments here" [(ngModel)]="commenting"
                          (keypress)="keypress2($event)" maxlength="100" required></textarea>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-danger fl" data-dismiss="modal">Cancel</button>
                <!-- <button type="button" class="btn btn-success fr" data-dismiss="modal" (click)="confirm_sub1(commenting)">Ok</button> -->
                <button type="button" class="btn btn-success fr" data-dismiss="modal" (click)="confirm_sub(commenting)"
                  value="">Ok</button>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="PENhidden">
          <div class="row" style="margin:0px">
            <div>
              <div>
                <div class="row tabcontent" style="padding: 10px;">
                  <div>
                    <div class="row p_s_1">
                      <div class="col-4 col-md-1 text-center">
                        <h4>S.No</h4>
                      </div>
                        <div class="col-md-2  hidexs">
                        <h4 >Business Name</h4>
                      </div>
                      <div class="col-4 col-md-1 text-center">
                        <h4>PO No</h4>
                      </div>
                      <div class="col-4 col-md-2  text-center">
                        <h4>PO Date</h4>
                      </div>
                      <div class="col-4 col-md-1 text-center">
                        <h4>Packing No</h4>
                      </div>
                      <div class="col-md-1  text-center hidexs">
                        <h4>Product Line</h4>
                      </div>
                      <div class="col-4 col-md-1  text-center pototal">
                        <h4> Taxable</h4>
                      </div>
                      <div class="col-4 col-md-1  text-center pototal">
                        <h4> Discount</h4>
                      </div>
                      <div class="col-4 col-md-1  text-center pototal">
                        <h4> Promo Discount</h4>
                      </div>
                      <div class="col-4 col-md-1  text-center pototal">
                        <h4>PO Total<br>(Including GST)</h4>
                      </div>
                    
                      <!-- <div  class="col-md-1  text-center hidexs">
                        <h4 >Raised By</h4>
                      </div> -->
                    </div>

                    <mat-accordion
                      *ngFor="let p of orders | filter:searchText| paginate: { itemsPerPage: 10, currentPage: page }; let i=index">

                      <div  class="statusdata">
                        <mat-expansion-panel [expanded]="indexExpanded == i" (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                          <mat-expansion-panel-header  (click)="getpendingOrdersdetail(p,i)">
                            <mat-panel-title>
                              <div class="col-md-1  text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{10*(page-1)+(i+1)}}</span>
                                </p>
                              </div>
                               <div class="col-md-2  hidexs">
                                <p class="txt_black" style="margin-bottom: 0px;text-align:left ">
                                  <span>&nbsp;&nbsp;{{p.business_name }}
                                  </span>
                                </p>
                              </div>
                              <div class="col-md-1  text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{p.spo_no }}
                                  </span>
                                </p>
                              </div>
                              <div class="col-md-2 podatediv">
                                <p class="txt_black" style="margin-bottom: 0px;text-align:right">
                                  <span>&nbsp;&nbsp;{{p.po_date | date:'dd-MM-yyyy'}}</span>
                                </p>
                              </div>
                              <div class="col-md-1  text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span *ngIf="p.packing_no!=null">&nbsp;&nbsp;{{p.packing_no }}
                                  </span>
                                  <span *ngIf="p.packing_no==null">&nbsp;&nbsp;-
                                  </span>
                                </p>
                              </div>
                              <div class="col-md-1  text-center hidexs">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{p.detail}}</span>
                                </p>
                              </div>
                              <div class="col-md-1 text-center currencydiv">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span style="position: absolute;right: 10%;">{{p.line_amount| currency : '&nbsp;' }}
                                  </span>
                                </p>
                              </div>
                              <div *ngIf="p.devicediscamount"  class="col-md-1 text-center currencydiv" >
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span style="position: absolute;right: 10%;">{{p.devicediscamount| currency : '&nbsp;' }}
                                  </span>
                                
                                </p>
                              </div>
                              <div *ngIf="!p.devicediscamount" class="col-md-1 text-center currencydiv" >
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span  style="position: absolute;right: 30%;">-
                                  </span>
                                
                                </p>
                              </div>
                              <div *ngIf="p.promo_amount" class="col-md-1 text-center currencydiv" >
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span  style="position: absolute;right: 10%;">{{p.promo_amount| currency : '&nbsp;' }}
                                  </span>
                                 
                                </p>
                              </div>
                              <div *ngIf="!p.promo_amount" class="col-md-1 text-center currencydiv" >
                                <p class="txt_black" style="margin-bottom: 0px;">
                                
                                  <span style="position: absolute;right: 30%;">-
                                  </span>
                                </p>
                              </div>
                              <div class="col-md-1  currencydiv">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span style="position: absolute;right: 5%;">{{p.final_amount| currency : '&nbsp;' }}
                                  </span>
                                </p>
                              </div>
                             
                              <!-- <div class="col-md-1  text-center hidexs" *ngIf="loginUserData.role=='Marketing Manager'">
                                <p *ngIf="p.self==1" class="txt_black" style="margin-bottom: 0px;color:red; ">
                                  <span>&nbsp;&nbsp;(S)
                                  </span>
                                </p>
                                <p *ngIf="p.self==0" class="txt_black" style="margin-bottom: 0px;color: #293271 ">
                                  <span>&nbsp;&nbsp;(D)
                                  </span>
                                </p>
                              </div> -->
                              <!-- <div class="col-md-1  text-center hidexs" *ngIf="loginUserData.role!='Marketing Manager'">
                                <p *ngIf="p.self==1" class="txt_black" style="margin-bottom: 0px;color:red; ">
                                  <span>&nbsp;&nbsp;(S)
                                  </span>
                                </p>
                                <p *ngIf="p.self==0" class="txt_black" style="margin-bottom: 0px;color: #293271 ">
                                  <span>&nbsp;&nbsp;(M)
                                  </span>
                                </p>
                              </div> -->
                            </mat-panel-title>


                          </mat-expansion-panel-header>
                          <div class="visible-sm-and-lg">
                            <div class="row">
                              <div class="col-md-6" style="margin-bottom: 0px;">
                                <span> <b> Product Line -</b>&nbsp;&nbsp;{{p.detail}}</span>
                              </div>
                              <div class="col-md-6" style="margin-bottom: 0px;">
                                <span> <b>Company -</b>&nbsp;&nbsp;{{p.business_name }}</span>
                              </div>
                            </div>

                          </div>
                          <div>
                            <h4>Order Details:</h4>
                            <!--<h4 style="float: right;" (click)="grnPrint(p.detail)">Print</h4> -->
                          </div>

                          <div style="max-height: 380px;overflow: auto;">
                          <div class="table-responsive">
                            <table class="table">
                              <thead>
                                <tr>
                                  <th>S.No</th>
                                  <th>Product </th>
                                  <th style="text-align:left;"><span class="hidexs">Product</span> Name</th>
                                  <th>Price(&#8377;)</th>
                                  <th>Qty</th>
                                  <th>Net <span class="hidexs">Price</span>(&#8377;)</th>
                                  <!-- <th>GST</th>
                                  <th>Total<span class="hidexs">Price</span>(&#8377;)</th> -->
                                  <th>Status</th>

                                </tr>
                              </thead>
                              <tbody>
                                <tr *ngFor="let pd of ordersdetail ; let i=index;">
                                  <td>{{i + 1}} </td>

                                  <td style="width:10%;">
                                    <div>
                                      <img src="https://s3.ap-south-1.amazonaws.com/gstbucket1/Powertexmodel/101_{{pd.modelno}}.png"
                                        onError="this.src='https://gstbucket1.s3.ap-south-1.amazonaws.com/Powertexmodel/noimage.png';"
                                        class="img-thumbnail" style="width:70%;height: 30px;">
                                    </div>
                                  </td>
                                  <td  style="text-align:left;">
                                    <h4 class="table_pd_name">{{pd.subcategory}} {{pd.modelno}}</h4>
                                  </td>
                                  <td>
                                    <div class="row_mar_0">
                                      <span class="f_wt_600">{{pd.net_price | currency : '&nbsp;'}}</span>
                                    </div>
                                  </td>
                                  <td>
                                    <div>
                                      <p>
                                        <span class=" f_wt_600">{{pd.qty }}</span>
                                      </p>
                                    </div>
                                  </td>
                                  <td>
                                    <div>
                                      <p style="margin-bottom: 0px">
                                        <span class=" f_wt_600">{{pd.qty * pd.net_price | currency : '&nbsp;'}}</span>
                                      </p>
                                         <!-- <p class="gsttitle">
                                        (Excluding GST)
                                      </p> -->
                                    </div>
                                  </td>
                                  <!-- <td>
                                    <div>
                                      <p>
                                        <span class=" f_wt_600">18% </span>
                                      </p>
                                    </div>
                                  </td>
                                  <td>
                                    <div>

                                      <span class="f_wt_600">{{pd.total_value| currency : '&nbsp;'}}</span>&nbsp;
                                         <p class="gsttitle">
                                        (Including GST)
                                      </p>
                                    </div>
                                  </td> -->
                                  <td>
                                    <div>
                                      <p>
                                        <span class=" f_wt_600">{{pd.Status}} &nbsp;
                                        
                                        </span>
                                      </p>

                                    </div>

                                  </td>
                                </tr>
                              </tbody>
                            </table>
                         </div>
                          </div>
                        </mat-expansion-panel>

                      </div>
                    
                    </mat-accordion>
                    <div class="pull-left mar_t_30">
                      <pagination-controls (pageChange)="page = $event"></pagination-controls>
                    </div>
                  </div>
                </div>
                <!-- <div class="col-md-12" >
                <div class="no_data">
                  <img class="no_data_cnter" src="../assets/emptyicon.png" />
                  <span class="nodata_txt">No Data is Available</span>
                </div>
              </div> -->
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="DOhidden" class="deliveredwrap">

          <div class="row" style="margin:0px">
            <div>
              <div>
                <div class="row tabcontent">

                  <div class="col-md-12 mar_t_20 ">
                    <div class="row p_s_1">
                      <div class="col-md-1  ">
                        <h4>S.No</h4>
                      </div>
                    <div class="col-md-2  ">
                        <h4>Business Name</h4>
                      </div>
                      <!-- <div class="col-md-1 text-center">
                        <h4>PO No</h4>
                      </div>
                      <div class="col-md-2 text-center hidexs">
                        <h4>PO Date</h4>
                      </div> -->
                      <div class="col-md-1  text-center">
                        <h4>Packing No</h4>
                      </div>
                      <div class="col-md-2  text-center">
                        <h4>Invoice No</h4>
                      </div>
                       <div class="col-md-1  text-center">
                        <h4>Invoice Date</h4>
                      </div>
                      <div class="col-md-1  text-center hidexs">
                        <h4>Product Line</h4>
                      </div>
                      <div class="col-4 col-md-1  text-center pototal">
                        <h4> Taxable</h4>
                      </div>
                      <div class="col-4 col-md-1  text-center pototal">
                        <h4> Discount</h4>
                      </div>
                      <div class="col-4 col-md-1  text-center pototal">
                        <h4> Promo Discount</h4>
                      </div>
                      <div class="col-4 col-md-1  text-center pototal">
                        <h4>PO Total<br>(Including GST)</h4>
                      </div>
                      
                      <!-- <div class="col-md-1  text-center">
                        <h4>Raised By</h4>
                      </div> -->
                    </div>
                    <mat-accordion
                      *ngFor="let p of orders | filter:searchText| paginate: { itemsPerPage: 10, currentPage: page1 };let i=index">
                      <!-- <div *ngIf="p.detail[0].status!=='Delivered'"> -->
                      <div>
                        <mat-expansion-panel [expanded]="indexExpanded == i" (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                          <mat-expansion-panel-header (click)="getdeliveredOrdersdetail(p,i)">
                            <mat-panel-title>
                              <div class="col-md-1  text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>{{10*(page1-1)+(i+1)}}</span>
                                </p>
                              </div>
                               <div class="col-md-2 text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span style="position: absolute;right: 0%;text-align:left">{{p.business_name }}
                                  </span>
                                </p>
                              </div>
                              <!-- <div class="col-md-1  text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{p.spo_no }}
                                  </span>
                                </p>
                              </div>
                              <div class="col-md-2   hidexs">
                                <p class="txt_black" style="margin-bottom: 0px;text-align:right;">
                                  <span>&nbsp;&nbsp;{{p.po_date | date:'dd-MM-yyyy'}}</span>
                                </p>
                              </div> -->
                              <div class="col-md-1  text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span >&nbsp;&nbsp;{{p.packing_no }}
                                  </span>
                                 
                                </p>
                              </div>
                              <div class="col-md-2  text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                 
                                  <span>{{p.refinvno}}
                                  </span>
                                </p>
                              </div>
                              <div class="col-md-1  ">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{p.inv_date | date:'dd-MM-yyyy'}}</span>
                                </p>
                              </div>
                              <div class="col-md-1  text-center hidexs">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{p.detail}}</span>
                                </p>
                              </div>
                              <div class="col-md-1 text-center currencydiv">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span style="position: absolute;right: 10%;">{{p.line_amount?p.line_amount.toLocaleString('en-IN'):''}}
                                  </span>
                                </p>
                              </div>
                              <div *ngIf="p.devicediscamount"  class="col-md-1 text-center currencydiv" >
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span style="position: absolute;right: 10%;">{{p.devicediscamount?p.devicediscamount.toLocaleString('en-IN'):''}}
                                  </span>
                                
                                </p>
                              </div>
                              <div *ngIf="!p.devicediscamount" class="col-md-1 text-center currencydiv" >
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span  style="position: absolute;right: 30%;">-
                                  </span>
                                
                                </p>
                              </div>
                              <div *ngIf="p.promo_amount" class="col-md-1 text-center currencydiv" >
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span  style="position: absolute;right: 10%;">{{p.promo_amount?p.promo_amount.toLocaleString('en-IN'):''}}
                                  </span>
                                 
                                </p>
                              </div>
                              <div *ngIf="!p.promo_amount" class="col-md-1 text-center currencydiv" >
                                <p class="txt_black" style="margin-bottom: 0px;">
                                
                                  <span style="position: absolute;right: 30%;">-
                                  </span>
                                </p>
                              </div>
                              <div class="col-md-1  currencydiv">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span style="position: absolute;right: 5%;">{{p.final_amount?p.final_amount.toLocaleString('en-IN'):''}}
                                  </span>
                                </p>
                              </div>
                             
                              <!-- <div *ngIf="loginUserData.role=='Marketing Manager'" class="col-md-1  text-center hidexs">
                                <p *ngIf="p.self==1" class="txt_black" style="margin-bottom: 0px;color:red; ">
                                  <span>&nbsp;&nbsp;(S)
                                  </span>
                                </p>
                                <p *ngIf="p.self==0" class="txt_black" style="margin-bottom: 0px;color: #293271 ">
                                  <span>&nbsp;&nbsp;(D)
                                  </span>
                                </p>
                              </div> -->
                              <!-- <div *ngIf="loginUserData.role!='Marketing Manager'" class="col-md-1  text-center hidexs">
                                <p *ngIf="p.self==1" class="txt_black" style="margin-bottom: 0px;color:red; ">
                                  <span>&nbsp;&nbsp;(S)
                                  </span>
                                </p>
                                <p *ngIf="p.self==0" class="txt_black" style="margin-bottom: 0px;color: #293271 ">
                                  <span>&nbsp;&nbsp;(M)
                                  </span>
                                </p>
                              </div> -->
                            </mat-panel-title>

                          </mat-expansion-panel-header>
                          <div class="visible-sm-and-lg">
                            <div class="row">
                              <div class="col-md-6" style="margin-bottom: 0px;">
                                <span> <b>Po Date -</b>&nbsp;&nbsp;{{p.po_date | date:'dd-MM-yyyy'}}</span>
                              </div>
                              <div class="col-md-6" style="margin-bottom: 0px;">
                                <span> <b> Product Line -</b>&nbsp;&nbsp;{{p.detail}}</span>
                              </div>

                            </div>

                          </div>

                          <div style="display: flex;">
                            <h4>Order Details:</h4>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <button class="btn btn-sm btn-info" (click)="dataURLtoFile()">
                              Inv Copy<i class="fa fa-download" aria-hidden="true"
                                style="padding-left:5px;padding-top:5px;cursor:pointer"></i>
                            </button>
                          </div>
                          <!-- <h4 style="float: right;" (click)="grnPrint(p.detail)">Print</h4> -->

                          <div class="table-responsive">
                            <table class="table">
                              <thead>
                                <tr>
                                  <th>S.No</th>
                                  <th>Product </th>
                                  <th  style="text-align:left;"><span class="hidexs">Product</span> Name</th>
                                  <th>Price(&#8377;)</th>
                                  <th>Qty</th>
                                  <th>Net Price(&#8377;)</th>
                                  <!-- <th>GST</th>
                                  <th>Total Price(&#8377;)</th> -->
                                  <th>Actions</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr *ngFor="let pd of ordersdetail; let i=index;">
                                  <td>{{i + 1}} </td>

                                  <td style="width:10%;">
                                    <div>
                                      <img src="https://s3.ap-south-1.amazonaws.com/gstbucket1/Powertexmodel/101_{{pd.modelno}}.png"
                                        onError="this.src='https://gstbucket1.s3.ap-south-1.amazonaws.com/Powertexmodel/noimage.png';"
                                        class="img-thumbnail" style="width:70%;height: 30px;">
                                    </div>
                                  </td>
                                  <td  style="text-align:left;"> 
                                    <h4  class="table_pd_name">{{pd.subcategory}} {{pd.modelno}}</h4>
                                  </td>
                                  <td>
                                    <div style="margin:0;">
                                      <span class="f_wt_600">{{pd.net_price | currency : '&nbsp;'}}</span>
                                    </div>
                                  </td>
                                  <td>
                                    <div class="mar_b_10">
                                      <p>
                                        <span class=" f_wt_600">{{pd.inv_qty }}</span>
                                      </p>
                                    </div>
                                  </td>
                                  <td>
                                    <div class="mar_b_10">
                                      <p style="margin-bottom: 0px">
                                        <span class=" f_wt_600">{{pd.inv_qty * pd.net_price | currency : '&nbsp;'}}</span>
                                      </p>
                                         <!-- <p class="gsttitle">
                                        (Excluding GST)
                                      </p> -->
                                    </div>
                                  </td>
                                  <!-- <td>
                                    <div class="mar_b_10">
                                      <p>
                                        <span class=" f_wt_600">18% </span>
                                      </p>
                                    </div>
                                  </td>
                                  <td>
                                    <div class="mar_b_10">
                                      <span ></span>
                                      <span >&#8377;&nbsp;</span>
                                      <span class="f_wt_600">{{pd.total_value | currency : '&nbsp;'}}</span>&nbsp;
                                         <p class="gsttitle">
                                        (Including GST)
                                      </p>
                                    </div>
                                  </td> -->
                                  <td>
                                    <!-- <div class="mar_b_10">
                                      <p>
                                        <span class=" f_wt_600">{{pd.status}} </span>
                                      </p>
                                    </div> -->
                                    <button class="track_btn" (click)="reorder(pd)">Re-Order</button>
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </mat-expansion-panel>
                      </div>
                    </mat-accordion>
                    <div class="pull-left mar_t_30">
                      <pagination-controls (pageChange)="page1 = $event"></pagination-controls>
                    </div>
                  </div>
                </div>
                <!-- <div class="col-md-12" >
                <div class="no_data">
                  <img class="no_data_cnter" src="../assets/emptyicon.png" />
                  <span class="nodata_txt">No Data is Available</span>
                </div>
              </div> -->
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="GRNhidden">
          <div class="row mar_b_15" >
            <div class="col-sm-12">
              <div class="fl">
              </div>
              <div class="fr">
                <input type="text" [(ngModel)]="searchText" (keyup)="searchdata(searchText)" placeholder="Search Here" class="search_style">
                <button type="submit" class="input_btn" (click)="searchdata(searchText)">Search</button>
              </div>
            </div>
          </div>
         
          <div class="row row_mar_0">
            <div class="row pad_10">
              <div>
                <div class="row p_s_1">
                  <div class="col-md-1 text-center">
                    <h4>S.No</h4>
                  </div>
  
                  <div class="col-md-3 hidexs">
                    <h4>Company Name</h4>
                  </div>
                  <div class="col-md-2">
                    <h4>Mobile No</h4>
                  </div>
                  <div class="col-md-2">
                    <h4>City</h4>
                  </div>
                  <div class="col-md-1  text-center">
                    <h4>Credit Period</h4>
                  </div>
                  <div class="col-md-1 text-center hidexs">
                    <h4>Credit Limit</h4>
                  </div>
                  <div class="col-md-2  text-center hidexs">
                    <h4>Outstanding Amount</h4>
                  </div>
                  <!-- <div class="col-md-2  text-center">
                        <h4 style="color:#ffff !important">PO Total</h4>
                      </div> -->
  
                  <!-- <div class="col-md-1  text-center" style="padding:0px !important;">
                        <h4 style="color:#ffff !important;float: left;">Actions</h4>
                      </div> -->
                </div>
  
                <mat-accordion
                  *ngFor="let p of cancelledorders | filter:searchText| paginate: { itemsPerPage: 10, currentPage: page2,totalItems: orderscount }; let i=index">
                  <!-- *ngIf="check_status(p.dt)" -->
                  <div >
                    <mat-expansion-panel [expanded]="indexExpanded == i"  (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                      <mat-expansion-panel-header (click)="getcancelledorders(p,i)">
                        <mat-panel-title>
                          <div class="col-md-1  text-center">
                            <p class="txt_black" style="margin-bottom: 0px;">
                              <span>&nbsp;&nbsp;{{10*(page2-1)+(i+1)}}</span>
                            </p>
                          </div>
  
                          <div class="col-md-3  hidexs">
                            <!-- <p class="txt_black" style="margin-bottom: 0px;">
                              <span>&nbsp;&nbsp;{{p.company_name }}
                              </span>
                            </p> -->
                            <p class="txt_black" style="margin-bottom: 0px;">
                              <span *ngIf="p.userprofiledtl.business_name !==''">&nbsp;&nbsp;{{p.userprofiledtl.business_name }}</span>
                                <span *ngIf="p.userprofiledtl.business_name ==''">&nbsp;&nbsp;customer po
                              </span>
                            </p>
                          </div>
                          <div class="col-md-2">
                            <p class="txt_black" style="margin-bottom: 0px; ">
                              <span>&nbsp;&nbsp;{{p.mobile }} </span>
                            </p>
                          </div>
                          <div class="col-md-2">
                            <p class="txt_black" style="margin-bottom: 0px; ">
                              <span>&nbsp;&nbsp;{{p.city }} </span>
                            </p>
                          </div>
                          <div class="col-md-1  text-center">
                            <p class="txt_black" style="margin-bottom: 0px;">
                              <span>&nbsp;&nbsp;{{p.userprofiledtl.credit_period}}</span>
                            </p>
                          </div>
                          <div class="col-md-1  text-center hidexs">
                            <p class="txt_black" style="margin-bottom: 0px;">
                              <span>&nbsp;&nbsp;{{p.userprofiledtl.credit_limit}}</span>
                            </p>
                          </div>
                          <div class="col-md-2 text-center hidexs">
                            <p class="txt_black" style="margin-bottom: 0px;">
                              <span style="position: absolute;right: 30%;" *ngIf="p.userprofiledtl.outstanding!=null">&#8377;
                                {{(p.userprofiledtl.outstanding).toLocaleString('en-IN')}}.<span *ngIf="!p.userprofiledtl.decimal">00</span>{{p.userprofiledtl.decimal}}</span>
                              <span style="position: absolute;right: 30%;" *ngIf="p.userprofiledtl.outstanding==null">-</span>
                            </p>
                          </div>
                          <!-- <div class="col-md-2 text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span style="position: absolute;right: 30%;">&#8377; {{p.amount}}</span>
                                </p>
                              </div> -->
  
                          <!-- <div class="col-md-1  text-center" style="padding:0px !important;">
                                <p class="txt_black" style="margin-bottom: 0px; ">
                                  <span><button  class="btn btn-danger" (click)="c_a(p)">Cancel All</button> </span>
                                </p>
                              </div> -->
                        </mat-panel-title>
  
  
                      </mat-expansion-panel-header>
                      <div class="visible-sm-and-lg form-group">
                        <p class="txt_black" style="margin-bottom: 0px;">
                          <b> Company Name :</b> <span>&nbsp;&nbsp;{{p.userprofiledtl.business_name }}
                          </span>
                        </p>
                        <p class="txt_black" style="margin-bottom: 0px;">
                          <b>Credit Period : </b> <span> &#8377;
                            {{p.userprofiledtl.credit_period}}</span>
                        </p>
                        <p class="txt_black" style="margin-bottom: 0px;">
                          <b>Credit Limit : </b> <span> &#8377;
                            {{p.userprofiledtl.credit_limit}}</span>
                        </p>
                        <p class="txt_black" style="margin-bottom: 0px;">
                          <b>Outstanding Amount : </b> <span *ngIf="p.userprofiledtl.outstanding!=null"> &#8377;
                            {{(p.userprofiledtl.outstanding).toLocaleString('en-IN')}}.<span *ngIf="!p.userprofiledtl.decimal">00</span>{{p.userprofiledtl.decimal}}</span>
                            <span *ngIf="p.userprofiledtl.outstanding==null">-</span>
                        </p>
  
                      </div>
  
                      <div class="row p_s_1">
                        <div class="col-md-1 text-center">
                          <h4>S.No</h4>
                        </div>
                        <!-- <div class="col-md-2  text-center">
                                <h4 style="color:#ffff !important">Company Code</h4>
                              </div> -->
                        <div class="col-md-1 text-center">
                          <h4>PO No</h4>
                        </div>
                        <div class="col-md-2  text-center">
                          <h4>PO Date</h4>
                        </div>
                        <div class="col-md-1  text-center">
                          <h4>Product Line</h4>
                        </div>
                        <!-- <div class="col-md-2  text-center hidexs">
                          <h4>Outstanding Amount</h4>
                        </div> -->
                        <div class="col-md-1  text-center hidexs">
                          <h4>Promo Amount</h4>
                        </div>
                        <div class="col-md-1  text-center hidexs">
                          <h4>Discount</h4>
                        </div>
                        <div class="col-md-2  text-center hidexs">
                          <h4>PO Total</h4>
                        </div>
  
                        <!-- <div class="col-md-1  text-center" style="padding:0px !important;">
                                <h4 style="color:#ffff !important;float: left;">Actions</h4>
                              </div> -->
                      </div>
                      <div *ngFor="let po of orders;let i=index">
                        <mat-expansion-panel>
                          <mat-expansion-panel-header>
                            <mat-panel-title>
  
                              <div class="col-md-1  text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                 <!--  <span>&nbsp;&nbsp;{{10*(page1-1)+(i+1)}}</span> -->
                                  <span>&nbsp;&nbsp; {{i + 1}}</span>
                                </p>
                              </div>
                              <!-- <div class="col-md-2  text-center">
                                        <p class="txt_black" style="margin-bottom: 0px; ">
                                          <span>&nbsp;&nbsp;{{po.company_code }} </span>
                                        </p>
                                      </div> -->
                              <div class="col-md-1  text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{po.spo_no }}
                                  </span>
                                </p>
                              </div>
                              <div class="col-md-2  ">
                                <p class="txt_black" style="margin-bottom: 0px;text-align:right;">
                                  <span>&nbsp;&nbsp;{{po.po_date | date:'dd-MM-yyyy'}}</span>
                                </p>
                              </div>
                              <div class="col-md-1  text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{po.detail.length}}</span>
                                </p>
                              </div>
                              <!-- <div class="col-md-2 text-center hidexs">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span *ngIf="po.outstatnding_amount" style="position: absolute;right: 30%;">&#8377;
                                    {{po.outstatnding_amount.toLocaleString('en-IN')}}.00</span>
                                    <span *ngIf="!po.outstatnding_amount" style="position: absolute;right: 40%;"> -</span>
                                </p>
                              </div> -->
                              <div class="col-md-1 text-center hidexs">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span *ngIf="po.promo_amount" style="position: absolute;right: 30%;">&#8377;
                                    {{po.promo_amount.toLocaleString('en-IN')}}.00</span>
                                  <span *ngIf="!po.promo_amount" style="position: absolute;right: 40%;"> -</span>
                                </p>
                              </div>
                              <div class="col-md-1 text-center hidexs">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span *ngIf="po.devicediscamount" style="position: absolute;right: 10%;">&#8377;
                                    {{po.devicediscamount.toLocaleString('en-IN')}}.00</span>
                                  <span *ngIf="!po.devicediscamount" style="position: absolute;right: 30%;"> -</span>
                                </p>
                              </div>
                              <div class="col-md-2 text-center hidexs">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span *ngIf="po.final_amount" style="position: absolute;right: 30%;">&#8377;
                                    {{po.final_amount.toLocaleString('en-IN')}}.{{po.decimalamount}}</span>
                                  <span *ngIf="!po.final_amount" style="position: absolute;right: 30%;">&#8377;
                                    {{po.amount.toLocaleString('en-IN')}}.00</span>
                                </p>
  
                              </div>
  
                              <!-- <div class="col-md-1  text-center" style="padding:0px !important;">
                                        <p class="txt_black" style="margin-bottom: 0px; ">
                                          <span><button  class="btn btn-danger" (click)="c_a(p)">Cancel All</button> </span>
                                        </p>
                                      </div> -->
  
                            </mat-panel-title>
                          </mat-expansion-panel-header>
                          <div class="visible-sm-and-lg form-group">
                            <p class="txt_black" style="margin-bottom: 0px;">
                              <b> Product Line :</b> <span>&nbsp;&nbsp;{{po.detail.length}}
                              </span>
                            </p>
                            <!-- <p class="txt_black" style="margin-bottom: 0px;">
                              <b>Outstanding Amount : </b> <span *ngIf="po.outstatnding_amount"> &#8377;
                                {{po.outstatnding_amount.toLocaleString('en-IN')}}.00</span>
                                <span *ngIf="!po.outstatnding_amount"> - </span>
                            </p> -->
                            <p class="txt_black" style="margin-bottom: 0px;">
                              <b>Promocode Applied Amount : </b> <span *ngIf="po.promo_amount"> &#8377;
                                {{po.promo_amount.toLocaleString('en-IN')}}.00</span>
                              <span *ngIf="!po.promo_amount"> - </span>
                            </p>
                            <p class="txt_black" style="margin-bottom: 0px;">
                              <b>PO Total :</b> <span *ngIf="po.final_amount"> &#8377;
                                {{po.final_amount.toLocaleString('en-IN')}}.{{po.decimalamount}}</span>
                              <span *ngIf="!po.final_amount"> &#8377;
                                {{po.amount.toLocaleString('en-IN')}}.00</span>
                            </p>
                          </div>
  
                         
  
                          <div style="max-height: 380px;overflow: auto;" class="table-responsive">
                            <table class="table" *ngIf="po.detail">
                              <thead>
                                <tr>
                                  <th>S.No</th>
                                  <th>Product </th>
                                  <th>Product Description</th>
                                  <th>Price</th>
                                  <th>Qty</th>
                                  <th>Net Amount</th>
                                  <th>GST</th>
                                  <th>Total Amount</th>
                                  <th>Status</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr *ngFor="let pd of po.detail ; let i=index;">
                                  <td>{{i + 1}} </td>
  
                                  <td style="width:10%;">
                                    <div>
                                      <img src="{{pd.image}}"
                                        onError="this.src='https://gstbucket1.s3.ap-south-1.amazonaws.com/Powertexmodel/noimage.png';"
                                        class="img-thumbnail" style="width:70%;height: 30px;">
                                    </div>
                                  </td>
                                  <td>
                                    <div class="row_mar_0">
                                      <span class="f_wt_600">{{pd.name}}</span>
                                    </div>
                                  </td>
                                  <td>
                                    <div class="row_mar_0">
                                      <span class="f_wt_600">{{pd.net_price | currency:'&nbsp;'}}</span>
                                    </div>
                                  </td>
                                  <td>
                                    <div>
                                      <p>
                                        <span class=" f_wt_600">{{pd.qty }}</span>
                                      </p>
                                    </div>
                                  </td>
                                  <td>
                                    <div>
                                      <p style="margin-bottom: 0px">
                                        <span class=" f_wt_600"> {{pd.tot_value | currency:'&nbsp;'}}</span>
                                      </p>
                                      <p class="p_e_g">(Excluding GST)</p>
                                    </div>
                                  </td>
                                  <td>
                                    <div>
                                      <p>
                                        <span class=" f_wt_600">{{pd.gst}}%</span>
                                      </p>
                                    </div>
                                  </td>
                                  <td>
                                    <div>
  
                                      <span class="f_wt_600"> {{pd.total_value | currency:'&nbsp;'}}</span>&nbsp;
                                      <p class="p_e_g">(Including GST)</p>
                                    </div>
                                  </td>
                                  <td>
                                    <div>
                                      <p>
                                        <span class=" f_wt_600">{{pd.status | titlecase}} &nbsp;
                                          <!-- <button *ngIf="!pd.Dispatched && pd.status !== 'canceled'" class="btn btn-danger" (click)="can_product(pd)">Cancel</button> -->
                                        </span>
                                      </p>
                                    </div>
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </mat-expansion-panel>
                      </div>
                    </mat-expansion-panel>
                  </div>
                </mat-accordion>
                <div class="pull-left mar_t_30">
                  <pagination-controls (pageChange)="onpagechange($event)"></pagination-controls>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- <div *ngIf="GRNhidden">
          <div class="row" style="margin:0px">
            <div>
              <div>
                <div class="row tabcontent" style="padding: 10px;" *ngIf="grn_data?.length>0">

                  <div>

                    <div class="row p_s_1">
                      
                      <div class="col-md-1 text-center">
                        <h4>S.No</h4>
                      </div>
                      <div class="col-md-2 text-center">
                        <h4>Invoice No</h4>
                      </div>
                      <div class="col-md-2 text-center">
                        <h4>Invoice Date</h4>
                      </div>
                      <div class="col-md-1 text-center">
                        <h4>GRN No</h4>
                      </div>
                      <div class="col-md-2  text-center">
                        <h4>GRN Date</h4>
                      </div>
                      <div class="col-md-1  text-center hidexs">
                        <h4>Product Line</h4>
                      </div>
                      <div class="col-md-2  text-center hidexs">
                        <h4>Purchased From</h4>
                      </div>
                      <div class="col-md-1  text-center finanwrap">
                        <h4>Financial Year</h4>
                      </div>
                    </div>

                    <mat-accordion
                      *ngFor="let g of grn_data | filter:searchText| paginate: { itemsPerPage: 10, currentPage: page }; let i=index">

                      <div *ngIf="check_status(g.detail)" class="statusdata">
                        <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false">
                          <mat-expansion-panel-header>
                            <mat-panel-title>
                              <div class="col-md-1  text-center">
                                <p class="txt_black" style=" margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{10*(page-1)+(i+1)}}</span>
                                </p>
                              </div>
                              <div class="col-md-2  text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{g.sinv_no }}
                                  </span>
                                </p>
                              </div>
                              <div class="col-md-2  text-center">
                                <p class="txt_black" style=" margin-bottom: 0px; ">
                                  <span>&nbsp;&nbsp;{{g.inv_date | date:'dd-MM-yyyy'}}</span>
                                </p>
                              </div>
                              <div class="col-md-1  text-center">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{g.grn_no }}
                                  </span>
                                </p>
                              </div>
                            
                              <div class="col-md-2  text-center">
                                <p class="txt_black" style=" margin-bottom: 0px; ">
                                  <span>&nbsp;&nbsp;{{g.grn_date | date:'dd-MM-yyyy'}}</span>
                                </p>
                              </div>
                              <div class="col-md-1  text-center hidexs">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{g.detail.length}}</span>
                                </p>
                              </div>
                              <div class="col-md-2 text-center hidexs">
                                <p class="txt_black" style="margin-bottom: 0px;">
                                  <span style="position: absolute;right: 0%;">
                                    {{g.purchase_from_company_name}}</span>
                                </p>
                              </div>
                              <div class="col-md-1  ">
                                <p class="txt_black" style=" margin-bottom: 0px;">
                                  <span>&nbsp;&nbsp;{{g.financial_year }}
                                  </span>
                                </p>
                              </div>
                            </mat-panel-title>


                          </mat-expansion-panel-header>
                          <div class="visible-sm-and-lg grnpurchasedwrap">
                            <div class="row">
                              <div style="margin-bottom: 0px;">
                                <span> <b> Product Line -</b>&nbsp;&nbsp;{{g.detail.length}}</span>
                              </div>
                              <div style="margin-bottom: 0px;">
                                <span> <b>Purchased From -</b>&nbsp;&nbsp;{{g.purchase_from_company_code}}</span>
                              </div>
                            </div>
                          </div>
                          <button class="btn btn-primary printbtn" style="float: right; cursor: pointer;"
                            (click)="grnPrint(g)">Print</button>

                          <h4 >Order Details:</h4>

                          <div style="max-height: 380px;overflow: auto;">
                          <div class="table-responsive">
                            <table class="table">
                              <thead>
                                <tr>
                                  <th>S.No</th>
                                
                                  <th>Product Name</th>
                                  <th>Price(&#8377;)</th>
                                  <th>Qty</th>
                                  <th>Net Amount(&#8377;)</th>
                                  <th>GST</th>
                                  <th>Total Amount(&#8377;)</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr *ngFor="let pd of g.detail ; let i=index;">
                                  <td>{{i + 1}} </td>
                                 
                                  <td>
                                    <h4  class="table_pd_name">{{pd.subcategory}} {{pd.modelno}}</h4>
                                  </td>
                                  <td>
                                    <div class="row_mar_0">
                                      <span class="f_wt_600">{{pd.net_price| currency : '&nbsp;'}}</span>
                                    </div>
                                  </td>
                                  <td>
                                    <div>
                                      <p>
                                        <span class=" f_wt_600">{{pd.receiving_qty }}</span>
                                      </p>
                                    </div>
                                  </td>
                                  <td>
                                    <div>
                                      <p style="margin-bottom: 0px">
                                        <span
                                          class=" f_wt_600">{{pd.receiving_qty * pd.net_price| currency : '&nbsp;'}}</span>
                                      </p>
                                         <p class="gsttitle">
                                        (Excluding GST)
                                      </p>
                                    </div>
                                  </td>
                                  <td>
                                    <div>
                                      <p>
                                        <span
                                          class=" f_wt_600">{{pd.receiving_qty * pd.net_price* 0.18 | currency : '&nbsp;'}}(18%)
                                        </span>
                                      </p>
                                    </div>
                                  </td>
                                  <td>
                                    <div>

                                      <span
                                        class="f_wt_600">{{pd.tot_value + (pd.receiving_qty * pd.net_price* 0.18) | currency : '&nbsp;'}}</span>&nbsp;
                                         <p class="gsttitle">
                                        (Including GST)
                                      </p>
                                    </div>
                                  </td>
                                 
                                </tr>
                              </tbody>
                            </table>
</div>
                          </div>
                        </mat-expansion-panel>
                      </div>
                    </mat-accordion>
                    <div class="pull-left mar_t_30">
                      <pagination-controls (pageChange)="page = $event"></pagination-controls>
                    </div>
                  </div>
                </div>
                <div class="col-md-12" *ngIf="grn_data?.length<=0">
                  <div class="no_data">
                    <img class="no_data_cnter" src="../assets/emptyicon.png" />
                    <span class="nodata_txt">No Data is Available</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div> -->
      </div>
    </div>
  </section>
  <ngx-spinner class="loader_spinner"></ngx-spinner>
</div>